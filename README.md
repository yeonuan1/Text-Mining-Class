# Text-Mining-Class
2024-1 기초빅데이터프로그래밍 기말프로젝트

## 프로젝트 주제
검색어를 입력하면 ‘블라인드’ 데이터를 형태소분석 후 워드클라우드를 제작하는 클래스 구현하기
## 프로젝트 개요
-	Input : 클래스 객체를 만들 때 ‘블라인드’에서 검색할 검색어를 매개변수로 주면 클래스의 크롤링 메서드를 통해 게시글의 제목, 내용과 댓글을 크롤링하여 데이터프레임을 만든다. 입력 데이터의 크기는 검색어에 따라 달라지나 일반적으로 100 이상이다.
-	Output : 크롤링한 데이터를 바탕으로 형태소 분석 메서드로 분석하고, 최종적으로 워드클라우드를 제외 단어를 추가해가며 반복 출력한다.

## 코드 개요

  ![alt text](image-7.png)

 클래스의 구성과 흐름은 위 그림과 같다. Crawling 클래스를 상속 받은 BlindCrawling 클래스로 ‘블라인드’ 데이터를 크롤링한 후 수집이 완료된 데이터프레임을 TextAnalyzer 클래스에 전달하여 전처리 및 형태소 분석을 진행한다. 이후 형태소 분석 결과와 빈도를 DrawWordCloud 클래스에 전달하여 워드클라우드를 그린다. 아래는 코드에 대한 간단한 설명이다.
 우선 분석에 필요한 패키지와 라이브러리를 모두 다운로드, 임포트한다.

-	checkTime 메서드: 현재 시간을 보여주고 크롤링 전반에 소요되는 시간을 측정한다.

-	Crawling 클래스: df1 속성은 크롤링한 데이터를 담을 데이터프레임이고, keyword 속성은 입력 받은 키워드로 ‘블라인드’에 검색할 단어이다. 각각을 protected 모드로 선언하고 property를 이용하여 참조 및 값 할당이 되도록 하였다.

-	BlindCrawling 클래스: 
 Crawling 클래스를 상속받았고 기타 Selenium 크롤링에 필요한 속성들을 추가로 가진다. Page_length는 검색어를 입력한 페이지에서 전체 글 개수를 나타내는 ’전체 글(204)’와 같은 텍스트를 가져와 정규표현식을 이용해 글 개수를 얻은 것이다.


-	Move_to_page 메서드: 블라인드 웹 페이지를 열고 검색을 위해 검색 버튼을 클릭한 뒤 유저로부터 입력 받은 keyword를 입력창에 보내는 기능을 한다.
-	Infinite_scrolling 메서드: 글 개수가 일정 개수를 넘어서면 아래로 스크롤을 내려야 새로운 페이지 및 게시글이 등장하는 구조이므로 웹 페이지의 맨 아래로 스크롤을 내린다.
-	 Start_crawling 메서드: 각 게시물의 Xpath 주소는 1부터 글 개수까지 순차적으로 증가하는 특징이 있다. 물론 중간에 삭제된 글이나 비공개 처리된 글 등으로 인해 전체 글 개수와 일치하지 않는 경우도 존재한다. 반복문으로 게시글을 하나씩 방문하여 해당 글이 존재하면 새 탭을 열어 방문하고, 존재하지 않아 NoSuchElementException이 발생하면 except문으로 페이지가 없다는 메시지를 출력한 후 반복문을 나온다. 정상적으로 페이지를 방문하였다면 제목과 내용, 댓글의 xpath 및class name 속성을 이용해 내용을 수집하고 이를 df1에 삽입한 뒤 해당 탭을 닫고 메인 페이지로 이동한다. 수집이 끝나면 완성된 데이터프레임의 정보를 출력하고, 제목과 내용, 댓글 칼럼을 ‘all’ 칼럼으로 합친 후 데이터프레임을 csv 파일로 내보낸다.

-	Process 메서드: BlindCrawling 클래스 내의 메서드를 순차적으로 호출하여 크롤링을 진행시킨다. 여기세 checkTime 메서드를 property로 달아 크롤링 진행 시간을 측정한다.

-	TextAnalyzer 클래스: 형태소 분석을 담당하는 클래스로, BlindCrawling 객체를 인자로 받아 객체의 속성 중 df1의 일부를 출력하고, ‘all’ 칼럼에 해당하는 부분을 data_1 데이터프레임에 복사한다. 추후 형태소 분석의 결과와 각각의 개수를 담을 document, counts 변수를 protected 모드로 선언하고 property로 값을 할당, 참조하도록 한다.


-	Word_count 메서드: 띄어쓰기나 특수문제를 제거하는 텍스트 클리닝 작업 후 Twitter 형태소 분석기를 이용하여 단어를 형태소 단위로 분리하고 품사가 명사인 것을 document에 append한다. Flatten 작업 후 전체 토큰 개수와 유니크 토큰 개수를 출력한 후 형태소 분석 결과를 pickle 형태로 저장한다.
-	process 메서드: 단어 사전에서 제외할 단어 목록을 만들고 전처리 메서드를 실행한 후 word_count 메서드에 data_1의 ‘all’ 칼럼을 매개변수로 넘겨 형태소 분석을 진행한다. 그 다음 DrawWordcloud 클래스의 객체를 생성하여 counts를 매개변수로 넘긴다.
-	DrawWordCloud 클래스: stop_word_cloud 리스트를 protected 모드로 선언한 다음 process 메서드를 실행한다. 
-	Draw_word_cloud 메서드: 미리 저장해둔 폰트와 원 그림을 바탕으로 워드 클라우드 객체를 생성한다. Stop_word_cloud 리스트에 있는 단어는 워드클라우드에서 제외하여 시각화한다. 


-	Process 메서드: while 문으로 반복하면서 워드 클라우드를 우선 그리고, 제외할 단어들을 쉼표로 구분하여 입력하여 워드 클라우드를 다시 그린다. 계속 반복하며 공백을 입력하면 종료한다.
-	main: 블라인드에 검색할 단어를 입력 받고 이를 BlindCrawling의 인자로 넘긴다. 이후 해당 객체를 TextAnalyzer의 인자로 넘긴다.
 
 ## 실행 결과
  ![alt text](image.png)
 검색할 단어를 입력하면 크롤링을 시작한다. 이후 현재 시간을 출력하고 크롤링할 전체 글 개수를 출력한다. 그리고 웹 페이지 최하단으로 스크롤을 내린 후 게시물을 순차적으로 방문하여 데이터를 수집한다.

![alt text](image-1.png)

 마지막 게시물 바로 다음 게시물에 도달하면 존재하지 않는 게시물이므로 ‘해당 페이지가 없습니다.’ 메시지를 띄우고 수집을 종료한다. 다음으로 수집된 데이터를 저장하는 데이터프레임의 정보를 띄우고, 크롤링에 소요된 시간을 출력한다. 다음으로 데이터프레임의 상위 5개 행을 출력하여 내용을 보여준다.




![alt text](image-2.png)


![alt text](image-3.png)



 형태소 분석을 시작하면 현재 시간을 출력하고 진행 상황을 나타내는 막대 그래프가 그려진다. 형태소 분석이 끝나면 전체 토큰 개수와 유니크 토큰 개수를 출력한다.


 다음으로 형태소 분석 결과를 바탕으로 워드클라우드를 출력한다.

![alt text](image-4.png)










 제외하고 싶은 단어를 입력하면 이를 제외한 워드클라우드를 다시 그린다. 유저가 공백을 입력할 때까지 반복한다. 이렇게 빈도가 큰 특정 단어들을 제외시켜가면서 워드클라우드를 관찰함으로써 키워드와 관련한 주제를 보다 자세하게 알아볼 수 있다. 추가로 제외할 단어를 입력하여 아래와 같이 다시 워드클라우드를 그렸다.
 ![alt text](image-5.png)

 ![alt text](image-6.png)
 마지막으로 ‘생각’ 단어를 제외하고 워드클라우드를 그린 후 공백을 입력하여 마무리하였다.














